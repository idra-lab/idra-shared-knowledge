<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Github Actions for CI/CD" href="../03_github_actions/00_index.html" /><link rel="prev" title="Linux and other Utilities" href="../00_index.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.04.27 -->
        <title>Docker - IDRA laboratory - Open Knowledge documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=437aa6ec" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">IDRA laboratory - Open Knowledge  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">IDRA laboratory - Open Knowledge  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../01_ros_2/00_index.html">ROS2 Notes</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of ROS2 Notes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../01_ros_2/01_CLI/00_index.html">CLI Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_ros_2/02_Packages/00_index.html">Workspaces and Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_ros_2/10_Simulation/00_index.html">Simulation Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../01_ros_2/30_gazebo/00_index.html">Gazebo Simulator</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../00_index.html">Linux and other Utilities</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Linux and other Utilities</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_github_actions/00_index.html">Github Actions for CI/CD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10_coppelia/00_index.html">Coppelia Simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_ssh/00_index.html">Fast ssh configuration for GitHub in Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_cuda/00_index.html">Nvidia Driver + Cuda Toolkit Installation guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_cuda/00_index.html#install-nvidia-drivers-in-ubuntu">Install Nvidia Drivers in Ubuntu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_cuda/00_index.html#install-the-nvidia-cuda-toolkit">Install the Nvidia Cuda Toolkit</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../03_demos/00_index.html">Demos</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Demos</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../03_demos/ultrasound-demo-guide.html">Teleoperated Ultrasonography Setup and Demo Guide</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="docker">
<h1>Docker<a class="headerlink" href="#docker" title="Link to this heading">¶</a></h1>
<section id="installation">
<span id="docker-installation"></span><h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<p>For more details follow the <a class="reference external" href="https://docs.docker.com/engine/install/ubuntu/">official installation guide</a>
to install in Ubuntu. In essence</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Add Docker&#39;s official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl gnupg
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg

# Add the repository to Apt sources:
echo \
  &quot;deb [arch=&quot;$(dpkg --print-architecture)&quot; signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
  &quot;$(. /etc/os-release &amp;&amp; echo &quot;$VERSION_CODENAME&quot;)&quot; stable&quot; | \
  sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
sudo apt-get update

# Install docker packages:
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you plan to use docker as github runner for CI/CD, provide privileges to the
<em>docker.sock</em> files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">chmod</span> <span class="mi">666</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">docker</span><span class="o">.</span><span class="n">sock</span>
</pre></div>
</div>
<p>More details <a class="reference external" href="https://stacktuts.com/got-permission-denied-while-trying-to-connect-to-the-docker-daemon-socket-at-unix-var-run-docker-sock-get-http-2fvar-2frun-2fdocker-sock-v1-24-version-dial-unix-var-run-docker-sock-connect-permission-denied">here</a>.</p>
</div>
<section id="arch-install">
<h3>Arch install<a class="headerlink" href="#arch-install" title="Link to this heading">¶</a></h3>
<p>Link to the <a class="reference external" href="https://wiki.archlinux.org/title/Docker">Arch Wiki</a>.
To install the docker engine:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>pacman<span class="w"> </span>-Sy<span class="w"> </span>docker
</pre></div>
</div>
<p>Then either the <code class="docutils literal notranslate"><span class="pre">docker.service</span></code> or the <code class="docutils literal notranslate"><span class="pre">docker.socket</span></code> system service must be enabled.
The former loads docker at boot up (thus more load time could be required), while the latter loads on first usage:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>docker.socket
<span class="c1"># Or alternatively</span>
<span class="c1"># sudo systemctl enable docker.socket</span>
</pre></div>
</div>
<p>As discussed in the Arch wiki page and <a class="reference external" href="https://www.configserverfirewall.com/ubuntu-linux/add-user-to-docker-group-ubuntu/">here</a>, to run docker with sudo privileges it is recommended to add the own <cite>user</cite> to the <code class="docutils literal notranslate"><span class="pre">docker</span></code> group.
You can check the existance of the group by calling</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>grep<span class="w"> </span>docker<span class="w"> </span>/etc/group
</pre></div>
</div>
<p>If the group exists, then add the user simply with the command</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span><span class="nv">$USER</span><span class="w">  </span><span class="c1"># or set the &lt;user_name&gt;</span>
</pre></div>
</div>
<p>or alternatively create the group:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>groupadd<span class="w"> </span>docker
</pre></div>
</div>
<p>After this operation, remember to restart the docker service:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>docker
</pre></div>
</div>
</section>
</section>
<section id="useful-commands">
<h2>Useful commands<a class="headerlink" href="#useful-commands" title="Link to this heading">¶</a></h2>
<p>To pull a image from the <a class="reference external" href="https://hub.docker.com/">DockerHub</a>, call</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>pull<span class="w"> </span>&lt;image_name&gt;:&lt;tag&gt;
</pre></div>
</div>
<p>For instance to pull the <a class="reference external" href="https://hub.docker.com/r/osrf/ros">ROS2 humble image</a> call <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">pull</span> <span class="pre">osrf/ros:humble-desktop-full</span></code>
(this image comes also with GUI applications, such RViz).</p>
<p>To see the already pulled images that are ready to run call</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>image<span class="w"> </span>ls
</pre></div>
</div>
<p>To create a container, call</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># docker image run &lt;image&gt;</span>
<span class="c1"># or, shorter,</span>
docker<span class="w"> </span>run<span class="w"> </span>&lt;image&gt;
</pre></div>
</div>
<p>In general, configuration arguments that must be passed to the image on boot up must be called <em>prior</em> to the image name,
while arguments that <em>follows</em> are executed on the spinned contained:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>&lt;docker_arguments&gt;<span class="w"> </span>&lt;image&gt;<span class="w"> </span>&lt;commands&gt;
</pre></div>
</div>
<p>A useful argument is <code class="docutils literal notranslate"><span class="pre">-ti</span></code> that boots the image and starts an <code class="docutils literal notranslate"><span class="pre">i</span></code> interactive <code class="docutils literal notranslate"><span class="pre">t</span></code> terminal.</p>
<p>To see currently runnint containers, call</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>container<span class="w"> </span>ls
<span class="c1"># or,</span>
<span class="c1"># docker ps</span>
</pre></div>
</div>
<p>To see already spinned containers that have been terminated, append the <code class="docutils literal notranslate"><span class="pre">-a</span></code> flag to the command.
Containers can be deleted with <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">container</span> <span class="pre">rm</span> <span class="pre">&lt;container_name&gt;</span> <span class="pre">-f</span></code>, with <code class="docutils literal notranslate"><span class="pre">-f</span></code> the <em>force</em> argument.
Additionally, you can pass the <code class="docutils literal notranslate"><span class="pre">--rm</span></code> flag to the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span></code> call to automatically delete the container when it stops spinning.</p>
<p>You can also start an already start a closed container or close a running container with the following commands:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>start<span class="w"> </span>&lt;container_name&gt;
docker<span class="w"> </span>stop<span class="w"> </span>&lt;container_name&gt;
</pre></div>
</div>
<section id="run-arguments">
<h3>Run arguments<a class="headerlink" href="#run-arguments" title="Link to this heading">¶</a></h3>
<p>The following is a list of useful launch arguments that can be paired with the <code class="docutils literal notranslate"><span class="pre">run</span></code> command to extend docker capabilities.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-it</span></code>: as already mentioned, starts the docker container and enters in the interactive terminal;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--rm</span></code>: removes the container instance after the container stops spinning;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--env</span> <span class="pre">&lt;VAR&gt;:&lt;VAL&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">-e</span> <span class="pre">&lt;VAR&gt;:&lt;VAL&gt;</span></code>: sets an environment variable <code class="docutils literal notranslate"><span class="pre">VAR</span></code> with <code class="docutils literal notranslate"><span class="pre">VALUE</span></code> on the container;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--net=&lt;CONFIG&gt;</span></code>: sets the networking configuration. Details can be found <a class="reference external" href="https://docs.docker.com/network/">here</a>,
but available configurations are <code class="docutils literal notranslate"><span class="pre">bridge</span></code> (default), <code class="docutils literal notranslate"><span class="pre">host</span></code> (recommended), <code class="docutils literal notranslate"><span class="pre">none</span></code>, <code class="docutils literal notranslate"><span class="pre">overlay</span></code>, <code class="docutils literal notranslate"><span class="pre">ipvlan</span></code>, <code class="docutils literal notranslate"><span class="pre">macvlan</span></code>.</p></li>
</ul>
</section>
<section id="x11-windows-forwarding">
<h3>X11 windows forwarding<a class="headerlink" href="#x11-windows-forwarding" title="Link to this heading">¶</a></h3>
<p>To enable X11 windows forwarding, you should provide the <code class="docutils literal notranslate"><span class="pre">run</span></code> command the following arguments:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>-e<span class="w"> </span><span class="nv">DISPLAY</span><span class="o">=</span><span class="nv">$DISPLAY</span><span class="w"> </span>-v<span class="w"> </span>/tmp/.X11-unix:/tmp/.X11-unix:rw
</pre></div>
</div>
<p>This command forwards the <code class="docutils literal notranslate"><span class="pre">DISPLAY</span></code> argument to the container and binds the X11 socket of the host machine to the container one
(see <a class="reference external" href="https://stackoverflow.com/questions/28392949/running-chromium-inside-docker-gtk-cannot-open-display-0">here</a> for further referencing).</p>
<p>If still you are unable to see the display and the terminal reports an error of the type <cite>cannot open display</cite>,
call the following command to enable docker to control the local X11 server:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>xhost<span class="w"> </span>+local:docker
</pre></div>
</div>
</section>
</section>
<section id="dockerfiles">
<h2>Dockerfiles<a class="headerlink" href="#dockerfiles" title="Link to this heading">¶</a></h2>
<p>To create a custom Docker image, it is simply necessary to write a <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code>.
Once the file is written, the image can be build with the command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>&lt;image_name&gt;<span class="w"> </span>&lt;path_to_Dockerfile&gt;&lt;:tag<span class="w"> </span><span class="o">(</span>optional<span class="o">)</span>&gt;
</pre></div>
</div>
<p>So let us now see how to write a <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code>.
In general the first line of a <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code> is the <code class="docutils literal notranslate"><span class="pre">FROM</span></code> command, which specifies the base image.
The base image can be either already built in the system or can be pulled from the Docker Hub registry.
For instance, the following is the statement to pull the Ubuntu 22.04 image from the Docker Hub registry:</p>
<div class="highlight-Docker notranslate"><div class="highlight"><pre><span></span><span class="k">FROM</span><span class="w"> </span><span class="s">ubuntu:22.04</span>
</pre></div>
</div>
<p>After the <code class="docutils literal notranslate"><span class="pre">FROM</span></code> command are placed all other instructions.
Keep in mind that since image building is a layer-based process, the order of the instructions is important to correctly use caching.</p>
<p>For instance, <code class="docutils literal notranslate"><span class="pre">RUN</span> <span class="pre">&lt;cmd&gt;</span></code> runs a given command in the shell and than layers the changes on the image.</p>
<p>To copy some files from the host machine to the image, the <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">&lt;host_dir&gt;</span> <span class="pre">&lt;img_dir&gt;</span></code> command is used.</p>
<p>To set the working directory of the image, the <code class="docutils literal notranslate"><span class="pre">WORKDIR</span> <span class="pre">&lt;dir&gt;</span></code> command is used.</p>
<p>To set the user of the image, the <code class="docutils literal notranslate"><span class="pre">USER</span> <span class="pre">&lt;user&gt;</span></code> command is used;
by default, <code class="docutils literal notranslate"><span class="pre">root</span></code> is selected, thus commands can be installed withouth the <code class="docutils literal notranslate"><span class="pre">sudo</span></code> keyword.</p>
<p>The last command of the <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code> is usually either <code class="docutils literal notranslate"><span class="pre">CMD</span></code> or <code class="docutils literal notranslate"><span class="pre">ENTRYPOINT</span></code>.
The main is that <code class="docutils literal notranslate"><span class="pre">CMD</span></code> is used to specify the default command to run when the container is started (if it was not specified through CLI),
while <code class="docutils literal notranslate"><span class="pre">ENTRYPOINT</span></code> is always executed and optional arguments are appended to it.
For further details, <a class="reference external" href="https://phoenixnap.com/kb/docker-cmd-vs-entrypoint">this</a> is a good article.</p>
<div class="highlight-Docker notranslate"><div class="highlight"><pre><span></span><span class="k">FROM</span><span class="w"> </span><span class="s">ubuntu:22.04</span>

<span class="c"># This is a good practice to install packages:</span>
<span class="c">#  1. to help caching, collect all the installation procedure in a single RUN command</span>
<span class="c">#  2. to avoid caching issues and save image space, base images come with available</span>
<span class="c">#     package lists that are empty.t So always first update the package list, then</span>
<span class="c">#     install the packages.</span>
<span class="c">#  3. to avoid caching issues, remove the package list after installation</span>
<span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>&lt;packages&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*

<span class="c"># This command copies the content of the current directory to the /application directory of the image</span>
<span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>/application

<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/application</span>
<span class="k">RUN</span><span class="w"> </span>touch<span class="w"> </span>test.txt

<span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Hello World!&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="docker-compose">
<h2>Docker Compose<a class="headerlink" href="#docker-compose" title="Link to this heading">¶</a></h2>
<p>As the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span></code> comman starts having lots of different argument that must be provided to it, it becomes hard to remember the exact command to start a container.
To overcome this limitation there are different methods, namely:</p>
<ul class="simple">
<li><p>write the command into a shell <code class="docutils literal notranslate"><span class="pre">.sh</span></code> script, make it executable (<code class="docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">+x</span></code>) and run it from the terminal;</p></li>
<li><p>for containers that are often used by the user, create an alias in the shell configuration file (<code class="docutils literal notranslate"><span class="pre">.bashrc</span></code>, <code class="docutils literal notranslate"><span class="pre">.zshrc</span></code>) to make it easier to run the command;</p></li>
<li><p>or, the preferrable way, is to use <strong>Docker Compose</strong>.</p></li>
</ul>
<p>Docker Compose is a tool that enables to configure and run multiple containers using a single <code class="docutils literal notranslate"><span class="pre">.yaml</span></code> configuration file.
Virtually, everything that can be done with the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span></code> command can be done with Docker Compose.</p>
<p>As an example, the file</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># File: docker-compose.yml</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myubuntu</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu:22.04</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DISPLAY=${DISPLAY}</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PRINTNAME=${USER}</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/.X11-unix:/tmp/.X11-unix</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash -c &quot;echo Hello, World!&quot;</span>
</pre></div>
</div>
<p>has the final result of the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">DISPLAY</span><span class="o">=</span><span class="nv">$DISPLAY</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">PRINTNAME</span><span class="o">=</span><span class="nv">$USER</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>/tmp/.X11-unix:/tmp/.X11-unix<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>ubuntu:22.04<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;echo Hello, World!&quot;</span>
</pre></div>
</div>
<p>To properly run the container through the Docker Compose command, first go to the directory where the <code class="docutils literal notranslate"><span class="pre">docker-compose.yaml</span></code> file is located and run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose<span class="w"> </span>up
</pre></div>
</div>
<p>This would yield the following output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="m">1</span>/0
<span class="w"> </span>✔<span class="w"> </span>Container<span class="w"> </span>test-myubuntu-1<span class="w">  </span>Created<span class="w">                                                                                                                     </span><span class="m">0</span>.0s
Attaching<span class="w"> </span>to<span class="w"> </span>myubuntu-1
myubuntu-1<span class="w">  </span><span class="p">|</span><span class="w"> </span>Hello,<span class="w"> </span>World!
myubuntu-1<span class="w"> </span>exited<span class="w"> </span>with<span class="w"> </span>code<span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
<p>In this case the <code class="docutils literal notranslate"><span class="pre">docker-compose.yaml</span></code> file was placed in a folder named <code class="docutils literal notranslate"><span class="pre">test</span></code>, thus the docker compose runtime created a container named <code class="docutils literal notranslate"><span class="pre">test-myubuntu-1</span></code>.
The output of the command <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">Hello,</span> <span class="pre">World!</span></code> was overlayed in the terminal and since all containers (1 in this case) finished, the docker compose command completed as well.</p>
<p>In general, to stop all containers created by the docker compose command, it is simply necessary to call <code class="docutils literal notranslate"><span class="pre">docker-compose</span> <span class="pre">down</span></code>.</p>
<p>The complete list of available commands that can be used in Docker compose <code class="docutils literal notranslate"><span class="pre">.yaml</span></code> files can be found <a class="reference external" href="https://github.com/compose-spec/compose-spec/blob/master/spec.md">here</a>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../03_github_actions/00_index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Github Actions for CI/CD</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../00_index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Linux and other Utilities</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; The IDRA team - 2023
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Docker</a><ul>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#arch-install">Arch install</a></li>
</ul>
</li>
<li><a class="reference internal" href="#useful-commands">Useful commands</a><ul>
<li><a class="reference internal" href="#run-arguments">Run arguments</a></li>
<li><a class="reference internal" href="#x11-windows-forwarding">X11 windows forwarding</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dockerfiles">Dockerfiles</a></li>
<li><a class="reference internal" href="#docker-compose">Docker Compose</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=4e2eecee"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>